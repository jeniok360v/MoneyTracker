Index: app/src/main/java/pl/cyfrogen/budget/Links.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package pl.cyfrogen.budget;\r\n\r\npublic class Links {\r\n    public static String PRIVACY_POLICY_LINK=\"https://github.com/jakubdybczak/budgetto/blob/master/PRIVACY_POLICY.md\";\r\n}\r\n
===================================================================
--- app/src/main/java/pl/cyfrogen/budget/Links.java	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/java/pl/cyfrogen/budget/Links.java	(date 1622847233849)
@@ -1,5 +1,5 @@
 package pl.cyfrogen.budget;
 
 public class Links {
-    public static String PRIVACY_POLICY_LINK="https://github.com/jakubdybczak/budgetto/blob/master/PRIVACY_POLICY.md";
+    public static String PRIVACY_POLICY_LINK="";
 }
Index: app/src/main/res/layout/top_categories_statistics_listview_row.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><android.support.constraint.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"72dp\"\r\n    android:orientation=\"vertical\"\r\n    android:paddingLeft=\"16dp\"\r\n    android:paddingTop=\"16dp\"\r\n    android:paddingRight=\"16dp\"\r\n    android:paddingBottom=\"16dp\">\r\n\r\n    <ImageView\r\n        android:id=\"@+id/icon_imageview\"\r\n        android:layout_width=\"40dp\"\r\n        android:layout_height=\"40dp\"\r\n        android:padding=\"10dp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        android:background=\"@drawable/icon_background_circle\"\r\n        android:src=\"@drawable/category_briefcase\"\r\n        android:tint=\"#FFFFFF\"\r\n        android:backgroundTint=\"@color/colorPrimary\"/>\r\n\r\n    <TextView\r\n        android:id=\"@+id/item_sum\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentEnd=\"true\"\r\n        android:layout_centerVertical=\"true\"\r\n        android:text=\"23$\"\r\n        android:textSize=\"18sp\"\r\n        android:textColor=\"@color/primary_text_income\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/item_percentage\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentEnd=\"true\"\r\n        android:layout_centerVertical=\"true\"\r\n        android:layout_marginStart=\"8dp\"\r\n        android:layout_marginEnd=\"24dp\"\r\n        android:text=\"4.76%\"\r\n        android:textColor=\"@color/primary_text_material_light\"\r\n        android:textSize=\"18sp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toStartOf=\"@+id/item_sum\"\r\n        app:layout_constraintStart_toEndOf=\"@+id/item_category\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:layout_constraintVertical_bias=\"0.52\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/item_category\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentTop=\"true\"\r\n        android:layout_centerVertical=\"true\"\r\n        android:layout_marginStart=\"16dp\"\r\n        android:layout_marginEnd=\"8dp\"\r\n        android:text=\"Category\"\r\n        android:textColor=\"@color/primary_text_material_light\"\r\n        android:textSize=\"16sp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toStartOf=\"@+id/item_percentage\"\r\n        app:layout_constraintStart_toEndOf=\"@+id/icon_imageview\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n\r\n</android.support.constraint.ConstraintLayout>
===================================================================
--- app/src/main/res/layout/top_categories_statistics_listview_row.xml	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/res/layout/top_categories_statistics_listview_row.xml	(date 1622811378274)
@@ -18,7 +18,7 @@
         app:layout_constraintStart_toStartOf="parent"
         app:layout_constraintTop_toTopOf="parent"
         android:background="@drawable/icon_background_circle"
-        android:src="@drawable/category_briefcase"
+        app:srcCompat="@drawable/category_briefcase"
         android:tint="#FFFFFF"
         android:backgroundTint="@color/colorPrimary"/>
 
Index: app/src/main/java/pl/cyfrogen/budget/ui/main/ViewPagerAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package pl.cyfrogen.budget.ui.main;\r\n\r\n\r\nimport android.support.v4.app.Fragment;\r\nimport android.support.v4.app.FragmentManager;\r\nimport android.support.v4.app.FragmentStatePagerAdapter;\r\n\r\nimport pl.cyfrogen.budget.ui.main.statistics.StatisticsFragment;\r\nimport pl.cyfrogen.budget.ui.main.history.HistoryFragment;\r\nimport pl.cyfrogen.budget.ui.main.home.HomeFragment;\r\n\r\npublic class ViewPagerAdapter extends FragmentStatePagerAdapter {\r\n\r\n    private static int TAB_COUNT = 3;\r\n\r\n    public ViewPagerAdapter(FragmentManager fm) {\r\n        super(fm);\r\n    }\r\n\r\n    @Override\r\n    public Fragment getItem(int position) {\r\n\r\n        switch (position) {\r\n            case 0:\r\n                return HomeFragment.newInstance();\r\n            case 1:\r\n                return HistoryFragment.newInstance();\r\n            case 2:\r\n                return StatisticsFragment.newInstance();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    @Override\r\n    public int getCount() {\r\n        return TAB_COUNT;\r\n    }\r\n\r\n    @Override\r\n    public CharSequence getPageTitle(int position) {\r\n        switch (position) {\r\n            case 0:\r\n                return HomeFragment.TITLE;\r\n\r\n            case 1:\r\n                return HistoryFragment.TITLE;\r\n\r\n            case 2:\r\n                return StatisticsFragment.TITLE;\r\n        }\r\n        return super.getPageTitle(position);\r\n    }\r\n}
===================================================================
--- app/src/main/java/pl/cyfrogen/budget/ui/main/ViewPagerAdapter.java	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/java/pl/cyfrogen/budget/ui/main/ViewPagerAdapter.java	(date 1622841781148)
@@ -50,4 +50,5 @@
         }
         return super.getPageTitle(position);
     }
-}
\ No newline at end of file
+}
+
Index: app/src/main/java/pl/cyfrogen/budget/ui/main/history/WalletEntriesRecyclerViewAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package pl.cyfrogen.budget.ui.main.history;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.content.Context;\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.content.res.ColorStateList;\r\nimport android.support.v4.app.FragmentActivity;\r\nimport android.support.v4.content.ContextCompat;\r\nimport android.support.v7.widget.RecyclerView;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\n\r\nimport com.google.firebase.database.FirebaseDatabase;\r\n\r\nimport java.text.DateFormat;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.Calendar;\r\nimport java.util.Date;\r\n\r\nimport pl.cyfrogen.budget.R;\r\nimport pl.cyfrogen.budget.firebase.FirebaseElement;\r\nimport pl.cyfrogen.budget.firebase.FirebaseObserver;\r\nimport pl.cyfrogen.budget.firebase.ListDataSet;\r\nimport pl.cyfrogen.budget.firebase.viewmodel_factories.UserProfileViewModelFactory;\r\nimport pl.cyfrogen.budget.firebase.viewmodel_factories.WalletEntriesHistoryViewModelFactory;\r\nimport pl.cyfrogen.budget.firebase.models.User;\r\nimport pl.cyfrogen.budget.firebase.models.WalletEntry;\r\nimport pl.cyfrogen.budget.util.CategoriesHelper;\r\nimport pl.cyfrogen.budget.models.Category;\r\nimport pl.cyfrogen.budget.ui.main.history.edit_entry.EditWalletEntryActivity;\r\nimport pl.cyfrogen.budget.util.CurrencyHelper;\r\n\r\npublic class WalletEntriesRecyclerViewAdapter extends RecyclerView.Adapter<WalletEntryHolder> {\r\n\r\n    private final String uid;\r\n    private final FragmentActivity fragmentActivity;\r\n    private ListDataSet<WalletEntry> walletEntries;\r\n\r\n    private User user;\r\n    private boolean firstUserSync = false;\r\n\r\n    public WalletEntriesRecyclerViewAdapter(FragmentActivity fragmentActivity, String uid) {\r\n        this.fragmentActivity = fragmentActivity;\r\n        this.uid = uid;\r\n\r\n        UserProfileViewModelFactory.getModel(uid,fragmentActivity).observe(fragmentActivity, new FirebaseObserver<FirebaseElement<User>>() {\r\n            @Override\r\n            public void onChanged(FirebaseElement<User> element) {\r\n                if(!element.hasNoError()) return;\r\n                WalletEntriesRecyclerViewAdapter.this.user = element.getElement();\r\n                if(!firstUserSync) {\r\n                    WalletEntriesHistoryViewModelFactory.getModel(uid, fragmentActivity).observe(fragmentActivity, new FirebaseObserver<FirebaseElement<ListDataSet<WalletEntry>>>() {\r\n                        @Override\r\n                        public void onChanged(FirebaseElement<ListDataSet<WalletEntry>> element) {\r\n                            if(element.hasNoError()) {\r\n                                walletEntries = element.getElement();\r\n                                element.getElement().notifyRecycler(WalletEntriesRecyclerViewAdapter.this);\r\n\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                notifyDataSetChanged();\r\n                firstUserSync = true;\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    @Override\r\n    public WalletEntryHolder onCreateViewHolder(ViewGroup parent, int viewType) {\r\n        LayoutInflater inflater = LayoutInflater.from(fragmentActivity);\r\n        View view = inflater.inflate(R.layout.history_listview_row, parent, false);\r\n        return new WalletEntryHolder(view);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(WalletEntryHolder holder, int position) {\r\n        String id = walletEntries.getIDList().get(position);\r\n        WalletEntry walletEntry = walletEntries.getList().get(position);\r\n        Category category = CategoriesHelper.searchCategory(user, walletEntry.categoryID);\r\n        holder.iconImageView.setImageResource(category.getIconResourceID());\r\n        holder.iconImageView.setBackgroundTintList(ColorStateList.valueOf(category.getIconColor()));\r\n        holder.categoryTextView.setText(category.getCategoryVisibleName(fragmentActivity));\r\n        holder.nameTextView.setText(walletEntry.name);\r\n\r\n        Date date = new Date(-walletEntry.timestamp);\r\n        DateFormat dateFormat = new SimpleDateFormat(\"dd-MM-yyyy HH:mm:ss\");\r\n        holder.dateTextView.setText(dateFormat.format(date));\r\n        holder.moneyTextView.setText(CurrencyHelper.formatCurrency(user.currency, walletEntry.balanceDifference));\r\n        holder.moneyTextView.setTextColor(ContextCompat.getColor(fragmentActivity,\r\n                walletEntry.balanceDifference < 0 ? R.color.primary_text_expense : R.color.primary_text_income));\r\n\r\n        holder.view.setOnLongClickListener(new View.OnLongClickListener() {\r\n            @Override\r\n            public boolean onLongClick(View v) {\r\n                createDeleteDialog(id, uid, walletEntry.balanceDifference, fragmentActivity);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        holder.view.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(fragmentActivity, EditWalletEntryActivity.class);\r\n                intent.putExtra(\"wallet-entry-id\", id);\r\n                fragmentActivity.startActivity(intent);\r\n            }\r\n        });\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        if (walletEntries == null) return 0;\r\n        return walletEntries.getList().size();\r\n    }\r\n\r\n    private void createDeleteDialog(String id, String uid, long balanceDifference, Context context) {\r\n        new AlertDialog.Builder(context)\r\n                .setMessage(\"Do you want to delete?\")\r\n                .setPositiveButton(\"Delete\", new DialogInterface.OnClickListener() {\r\n\r\n                    public void onClick(DialogInterface dialog, int whichButton) {\r\n                        FirebaseDatabase.getInstance().getReference()\r\n                                .child(\"wallet-entries\").child(uid).child(\"default\").child(id).removeValue();\r\n                        user.wallet.sum -= balanceDifference;\r\n                        UserProfileViewModelFactory.saveModel(uid, user);\r\n                        dialog.dismiss();\r\n                    }\r\n\r\n                })\r\n\r\n                .setNegativeButton(\"cancel\", new DialogInterface.OnClickListener() {\r\n                    public void onClick(DialogInterface dialog, int which) {\r\n\r\n                        dialog.dismiss();\r\n\r\n                    }\r\n                })\r\n                .create().show();\r\n\r\n    }\r\n\r\n    public void setDateRange(Calendar calendarStart, Calendar calendarEnd) {\r\n        WalletEntriesHistoryViewModelFactory.getModel(uid, fragmentActivity).setDateFilter(calendarStart, calendarEnd);\r\n    }\r\n\r\n\r\n}
===================================================================
--- app/src/main/java/pl/cyfrogen/budget/ui/main/history/WalletEntriesRecyclerViewAdapter.java	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/java/pl/cyfrogen/budget/ui/main/history/WalletEntriesRecyclerViewAdapter.java	(date 1622811378588)
@@ -1,12 +1,12 @@
 package pl.cyfrogen.budget.ui.main.history;
 
-import android.app.AlertDialog;
 import android.content.Context;
 import android.content.DialogInterface;
 import android.content.Intent;
 import android.content.res.ColorStateList;
 import android.support.v4.app.FragmentActivity;
 import android.support.v4.content.ContextCompat;
+import android.support.v7.app.AlertDialog;
 import android.support.v7.widget.RecyclerView;
 import android.view.LayoutInflater;
 import android.view.View;
@@ -23,13 +23,13 @@
 import pl.cyfrogen.budget.firebase.FirebaseElement;
 import pl.cyfrogen.budget.firebase.FirebaseObserver;
 import pl.cyfrogen.budget.firebase.ListDataSet;
-import pl.cyfrogen.budget.firebase.viewmodel_factories.UserProfileViewModelFactory;
-import pl.cyfrogen.budget.firebase.viewmodel_factories.WalletEntriesHistoryViewModelFactory;
 import pl.cyfrogen.budget.firebase.models.User;
 import pl.cyfrogen.budget.firebase.models.WalletEntry;
-import pl.cyfrogen.budget.util.CategoriesHelper;
+import pl.cyfrogen.budget.firebase.viewmodel_factories.UserProfileViewModelFactory;
+import pl.cyfrogen.budget.firebase.viewmodel_factories.WalletEntriesHistoryViewModelFactory;
 import pl.cyfrogen.budget.models.Category;
 import pl.cyfrogen.budget.ui.main.history.edit_entry.EditWalletEntryActivity;
+import pl.cyfrogen.budget.util.CategoriesHelper;
 import pl.cyfrogen.budget.util.CurrencyHelper;
 
 public class WalletEntriesRecyclerViewAdapter extends RecyclerView.Adapter<WalletEntryHolder> {
Index: app/src/main/java/pl/cyfrogen/budget/ui/main/history/HistoryFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package pl.cyfrogen.budget.ui.main.history;\r\n\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.support.annotation.Nullable;\r\nimport android.support.v4.content.ContextCompat;\r\nimport android.support.v7.widget.LinearLayoutManager;\r\nimport android.support.v7.widget.RecyclerView;\r\nimport android.view.LayoutInflater;\r\nimport android.view.Menu;\r\nimport android.view.MenuInflater;\r\nimport android.view.MenuItem;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.TextView;\r\n\r\nimport com.leavjenn.smoothdaterangepicker.date.SmoothDateRangePickerFragment;\r\n\r\nimport java.text.DateFormat;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.Calendar;\r\n\r\nimport pl.cyfrogen.budget.R;\r\nimport pl.cyfrogen.budget.firebase.viewmodel_factories.WalletEntriesHistoryViewModelFactory;\r\nimport pl.cyfrogen.budget.base.BaseFragment;\r\nimport pl.cyfrogen.budget.ui.options.OptionsActivity;\r\n\r\npublic class HistoryFragment extends BaseFragment {\r\n    public static final CharSequence TITLE = \"History\";\r\n    Calendar calendarStart;\r\n    Calendar calendarEnd;\r\n    private RecyclerView historyRecyclerView;\r\n    private WalletEntriesRecyclerViewAdapter historyRecyclerViewAdapter;\r\n    private Menu menu;\r\n    private TextView dividerTextView;\r\n\r\n    public static HistoryFragment newInstance() {\r\n\r\n        return new HistoryFragment();\r\n    }\r\n\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setHasOptionsMenu(true);\r\n    }\r\n\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_history, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {\r\n        dividerTextView = view.findViewById(R.id.divider_textview);\r\n        dividerTextView.setText(\"Last 100 elements:\");\r\n        historyRecyclerView = view.findViewById(R.id.history_recycler_view);\r\n        historyRecyclerView.setLayoutManager(new LinearLayoutManager(getActivity().getApplicationContext()));\r\n        historyRecyclerViewAdapter = new WalletEntriesRecyclerViewAdapter(getActivity(), getUid());\r\n        historyRecyclerView.setAdapter(historyRecyclerViewAdapter);\r\n\r\n        historyRecyclerViewAdapter.registerAdapterDataObserver(new RecyclerView.AdapterDataObserver() {\r\n            @Override\r\n            public void onItemRangeInserted(int positionStart, int itemCount) {\r\n                historyRecyclerView.smoothScrollToPosition(0);\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    @Override\r\n    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {\r\n        inflater.inflate(R.menu.history_fragment_menu, menu);\r\n        this.menu = menu;\r\n        updateCalendarIcon();\r\n        super.onCreateOptionsMenu(menu, inflater);\r\n    }\r\n\r\n\r\n    @Override\r\n    public boolean onOptionsItemSelected(MenuItem item) {\r\n        switch (item.getItemId()) {\r\n            case R.id.action_date_range:\r\n                showSelectDateRangeDialog();\r\n                return true;\r\n            case R.id.action_options:\r\n                startActivity(new Intent(getActivity(), OptionsActivity.class));\r\n                return true;\r\n            default:\r\n                return super.onOptionsItemSelected(item);\r\n        }\r\n    }\r\n\r\n    private void updateCalendarIcon() {\r\n        MenuItem calendarIcon = menu.findItem(R.id.action_date_range);\r\n        if (calendarIcon == null) return;\r\n        WalletEntriesHistoryViewModelFactory.Model model = WalletEntriesHistoryViewModelFactory.getModel(getUid(), getActivity());\r\n        if (model.hasDateSet()) {\r\n            calendarIcon.setIcon(ContextCompat.getDrawable(getContext(), R.drawable.icon_calendar_active));\r\n\r\n            DateFormat dateFormat = new SimpleDateFormat(\"dd-MM-yy\");\r\n\r\n            dividerTextView.setText(\"Date range: \" + dateFormat.format(model.getStartDate().getTime())\r\n                    + \"  -  \" + dateFormat.format(model.getEndDate().getTime()));\r\n        } else {\r\n            calendarIcon.setIcon(ContextCompat.getDrawable(getContext(), R.drawable.icon_calendar));\r\n\r\n            dividerTextView.setText(\"Last 100 elements:\");\r\n        }\r\n\r\n    }\r\n\r\n    private void showSelectDateRangeDialog() {\r\n        SmoothDateRangePickerFragment datePicker = SmoothDateRangePickerFragment.newInstance(new SmoothDateRangePickerFragment.OnDateRangeSetListener() {\r\n            @Override\r\n            public void onDateRangeSet(SmoothDateRangePickerFragment view, int yearStart, int monthStart, int dayStart, int yearEnd, int monthEnd, int dayEnd) {\r\n                calendarStart = Calendar.getInstance();\r\n                calendarStart.set(yearStart, monthStart, dayStart);\r\n                calendarStart.set(Calendar.HOUR_OF_DAY, 0);\r\n                calendarStart.set(Calendar.MINUTE, 0);\r\n                calendarStart.set(Calendar.SECOND, 0);\r\n\r\n                calendarEnd = Calendar.getInstance();\r\n                calendarEnd.set(yearEnd, monthEnd, dayEnd);\r\n                calendarEnd.set(Calendar.HOUR_OF_DAY, 23);\r\n                calendarEnd.set(Calendar.MINUTE, 59);\r\n                calendarEnd.set(Calendar.SECOND, 59);\r\n                calendarUpdated();\r\n                updateCalendarIcon();\r\n            }\r\n        });\r\n        datePicker.setOnCancelListener(new DialogInterface.OnCancelListener() {\r\n            @Override\r\n            public void onCancel(DialogInterface dialog) {\r\n                calendarStart = null;\r\n                calendarEnd = null;\r\n                calendarUpdated();\r\n                updateCalendarIcon();\r\n            }\r\n        });\r\n        datePicker.show(getActivity().getFragmentManager(), \"TAG\");\r\n        //todo library doesn't respect other method than deprecated\r\n    }\r\n\r\n    private void calendarUpdated() {\r\n        historyRecyclerViewAdapter.setDateRange(calendarStart, calendarEnd);\r\n    }\r\n\r\n}\r\n
===================================================================
--- app/src/main/java/pl/cyfrogen/budget/ui/main/history/HistoryFragment.java	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/java/pl/cyfrogen/budget/ui/main/history/HistoryFragment.java	(date 1622815817353)
@@ -22,8 +22,8 @@
 import java.util.Calendar;
 
 import pl.cyfrogen.budget.R;
-import pl.cyfrogen.budget.firebase.viewmodel_factories.WalletEntriesHistoryViewModelFactory;
 import pl.cyfrogen.budget.base.BaseFragment;
+import pl.cyfrogen.budget.firebase.viewmodel_factories.WalletEntriesHistoryViewModelFactory;
 import pl.cyfrogen.budget.ui.options.OptionsActivity;
 
 public class HistoryFragment extends BaseFragment {
@@ -142,8 +142,7 @@
                 updateCalendarIcon();
             }
         });
-        datePicker.show(getActivity().getFragmentManager(), "TAG");
-        //todo library doesn't respect other method than deprecated
+
     }
 
     private void calendarUpdated() {
Index: app/src/main/java/pl/cyfrogen/budget/ui/main/statistics/StatisticsFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package pl.cyfrogen.budget.ui.main.statistics;\r\n\r\nimport android.content.Intent;\r\nimport android.graphics.Color;\r\nimport android.graphics.drawable.Drawable;\r\nimport android.os.Bundle;\r\nimport android.support.annotation.Nullable;\r\nimport android.support.v4.content.ContextCompat;\r\nimport android.view.LayoutInflater;\r\nimport android.view.Menu;\r\nimport android.view.MenuInflater;\r\nimport android.view.MenuItem;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ListView;\r\nimport android.widget.ProgressBar;\r\nimport android.widget.TextView;\r\n\r\nimport com.github.mikephil.charting.charts.PieChart;\r\nimport com.github.mikephil.charting.data.PieData;\r\nimport com.github.mikephil.charting.data.PieDataSet;\r\nimport com.github.mikephil.charting.data.PieEntry;\r\nimport com.leavjenn.smoothdaterangepicker.date.SmoothDateRangePickerFragment;\r\n\r\nimport java.text.DateFormat;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.Collections;\r\nimport java.util.Comparator;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\nimport pl.cyfrogen.budget.R;\r\nimport pl.cyfrogen.budget.base.BaseFragment;\r\nimport pl.cyfrogen.budget.firebase.FirebaseElement;\r\nimport pl.cyfrogen.budget.firebase.FirebaseObserver;\r\nimport pl.cyfrogen.budget.firebase.ListDataSet;\r\nimport pl.cyfrogen.budget.firebase.models.User;\r\nimport pl.cyfrogen.budget.firebase.models.WalletEntry;\r\nimport pl.cyfrogen.budget.firebase.viewmodel_factories.TopWalletEntriesStatisticsViewModelFactory;\r\nimport pl.cyfrogen.budget.firebase.viewmodel_factories.UserProfileViewModelFactory;\r\nimport pl.cyfrogen.budget.util.CalendarHelper;\r\nimport pl.cyfrogen.budget.util.CategoriesHelper;\r\nimport pl.cyfrogen.budget.models.Category;\r\nimport pl.cyfrogen.budget.ui.options.OptionsActivity;\r\nimport pl.cyfrogen.budget.util.CurrencyHelper;\r\n\r\n\r\npublic class StatisticsFragment extends BaseFragment {\r\n    public static final CharSequence TITLE = \"Statistics\";\r\n\r\n    private Menu menu;\r\n    private Calendar calendarStart;\r\n    private Calendar calendarEnd;\r\n    private User user;\r\n    private ListDataSet<WalletEntry> walletEntryListDataSet;\r\n    private PieChart pieChart;\r\n    private ArrayList<TopCategoryStatisticsListViewModel> categoryModelsHome;\r\n    private TopCategoriesStatisticsAdapter adapter;\r\n    private TextView dividerTextView;\r\n    private ProgressBar incomesExpensesProgressBar;\r\n    private TextView incomesTextView;\r\n    private TextView expensesTextView;\r\n\r\n    public static StatisticsFragment newInstance() {\r\n\r\n        return new StatisticsFragment();\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setHasOptionsMenu(true);\r\n    }\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_statistics, container, false);\r\n\r\n\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {\r\n        pieChart = view.findViewById(R.id.pie_chart);\r\n        dividerTextView = view.findViewById(R.id.divider_textview);\r\n        View incomesExpensesView = view.findViewById(R.id.incomes_expenses_view);\r\n        incomesExpensesProgressBar = incomesExpensesView.findViewById(R.id.progress_bar);\r\n        expensesTextView = incomesExpensesView.findViewById(R.id.expenses_textview);\r\n        incomesTextView = incomesExpensesView.findViewById(R.id.incomes_textview);\r\n\r\n        categoryModelsHome = new ArrayList<>();\r\n        ListView favoriteListView = view.findViewById(R.id.favourite_categories_list_view);\r\n        adapter = new TopCategoriesStatisticsAdapter(categoryModelsHome, getActivity().getApplicationContext());\r\n        favoriteListView.setAdapter(adapter);\r\n\r\n        TopWalletEntriesStatisticsViewModelFactory.getModel(getUid(), getActivity()).observe(this, new FirebaseObserver<FirebaseElement<ListDataSet<WalletEntry>>>() {\r\n\r\n            @Override\r\n            public void onChanged(FirebaseElement<ListDataSet<WalletEntry>> firebaseElement) {\r\n                if (firebaseElement.hasNoError()) {\r\n                    StatisticsFragment.this.walletEntryListDataSet = firebaseElement.getElement();\r\n                    dataUpdated();\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n\r\n        UserProfileViewModelFactory.getModel(getUid(), getActivity()).observe(this, new FirebaseObserver<FirebaseElement<User>>() {\r\n            @Override\r\n            public void onChanged(FirebaseElement<User> firebaseElement) {\r\n                if (firebaseElement.hasNoError()) {\r\n                    StatisticsFragment.this.user = firebaseElement.getElement();\r\n\r\n                    calendarStart = CalendarHelper.getUserPeriodStartDate(user);\r\n                    calendarEnd = CalendarHelper.getUserPeriodEndDate(user);\r\n\r\n                    updateCalendarIcon(false);\r\n                    calendarUpdated();\r\n                    dataUpdated();\r\n\r\n                }\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n    private void dataUpdated() {\r\n        if (calendarStart != null && calendarEnd != null && walletEntryListDataSet != null) {\r\n            List<WalletEntry> entryList = new ArrayList<>(walletEntryListDataSet.getList());\r\n\r\n            long expensesSumInDateRange = 0;\r\n            long incomesSumInDateRange = 0;\r\n\r\n            HashMap<Category, Long> categoryModels = new HashMap<>();\r\n            for (WalletEntry walletEntry : entryList) {\r\n                if (walletEntry.balanceDifference > 0) {\r\n                    incomesSumInDateRange += walletEntry.balanceDifference;\r\n                    continue;\r\n                }\r\n                expensesSumInDateRange += walletEntry.balanceDifference;\r\n                Category category = CategoriesHelper.searchCategory(user, walletEntry.categoryID);\r\n                if (categoryModels.get(category) != null)\r\n                    categoryModels.put(category, categoryModels.get(category) + walletEntry.balanceDifference);\r\n                else\r\n                    categoryModels.put(category, walletEntry.balanceDifference);\r\n\r\n            }\r\n\r\n            categoryModelsHome.clear();\r\n\r\n            ArrayList<PieEntry> pieEntries = new ArrayList<>();\r\n            ArrayList<Integer> pieColors = new ArrayList<>();\r\n\r\n            for (Map.Entry<Category, Long> categoryModel : categoryModels.entrySet()) {\r\n                float percentage = categoryModel.getValue() / (float) expensesSumInDateRange;\r\n                final float minPercentageToShowLabelOnChart = 0.1f;\r\n                categoryModelsHome.add(new TopCategoryStatisticsListViewModel(categoryModel.getKey(), categoryModel.getKey().getCategoryVisibleName(getContext()),\r\n                        user.currency, categoryModel.getValue(), percentage));\r\n                if (percentage > minPercentageToShowLabelOnChart) {\r\n                    Drawable drawable = getContext().getDrawable(categoryModel.getKey().getIconResourceID());\r\n                    drawable.setTint(Color.parseColor(\"#FFFFFF\"));\r\n                    pieEntries.add(new PieEntry(-categoryModel.getValue(), drawable));\r\n\r\n                } else {\r\n                    pieEntries.add(new PieEntry(-categoryModel.getValue()));\r\n                }\r\n                pieColors.add(categoryModel.getKey().getIconColor());\r\n            }\r\n\r\n            PieDataSet pieDataSet = new PieDataSet(pieEntries, \"\");\r\n            pieDataSet.setDrawValues(false);\r\n            pieDataSet.setColors(pieColors);\r\n            pieDataSet.setSliceSpace(2f);\r\n\r\n            PieData data = new PieData(pieDataSet);\r\n            pieChart.setData(data);\r\n            pieChart.setTouchEnabled(false);\r\n            pieChart.getLegend().setEnabled(false);\r\n            pieChart.getDescription().setEnabled(false);\r\n\r\n            pieChart.setDrawHoleEnabled(true);\r\n            pieChart.setHoleColor(ContextCompat.getColor(getContext(), R.color.backgroundPrimary));\r\n            pieChart.setHoleRadius(55f);\r\n            pieChart.setTransparentCircleRadius(55f);\r\n            pieChart.setDrawCenterText(true);\r\n            pieChart.setRotationAngle(270);\r\n            pieChart.setRotationEnabled(false);\r\n            pieChart.setHighlightPerTapEnabled(true);\r\n\r\n            pieChart.invalidate();\r\n\r\n            Collections.sort(categoryModelsHome, new Comparator<TopCategoryStatisticsListViewModel>() {\r\n                @Override\r\n                public int compare(TopCategoryStatisticsListViewModel o1, TopCategoryStatisticsListViewModel o2) {\r\n                    return Long.compare(o1.getMoney(), o2.getMoney());\r\n                }\r\n            });\r\n\r\n\r\n            adapter.notifyDataSetChanged();\r\n\r\n            DateFormat dateFormat = new SimpleDateFormat(\"dd-MM-yy\");\r\n\r\n            dividerTextView.setText(\"Date range: \" + dateFormat.format(calendarStart.getTime())\r\n                    + \"  -  \" + dateFormat.format(calendarEnd.getTime()));\r\n\r\n            expensesTextView.setText(CurrencyHelper.formatCurrency(user.currency, expensesSumInDateRange));\r\n            incomesTextView.setText(CurrencyHelper.formatCurrency(user.currency, incomesSumInDateRange));\r\n\r\n            float progress = 100 * incomesSumInDateRange / (float) (incomesSumInDateRange - expensesSumInDateRange);\r\n            incomesExpensesProgressBar.setProgress((int) progress);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    @Override\r\n    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {\r\n        inflater.inflate(R.menu.statistics_fragment_menu, menu);\r\n        this.menu = menu;\r\n        updateCalendarIcon(false);\r\n        super.onCreateOptionsMenu(menu, inflater);\r\n    }\r\n\r\n    private void updateCalendarIcon(boolean updatedFromUI) {\r\n        if (menu == null) return;\r\n        MenuItem calendarIcon = menu.findItem(R.id.action_date_range);\r\n        if (calendarIcon == null) return;\r\n        if (updatedFromUI) {\r\n            calendarIcon.setIcon(ContextCompat.getDrawable(getContext(), R.drawable.icon_calendar_active));\r\n        } else {\r\n            calendarIcon.setIcon(ContextCompat.getDrawable(getContext(), R.drawable.icon_calendar));\r\n        }\r\n\r\n    }\r\n\r\n\r\n    @Override\r\n    public boolean onOptionsItemSelected(MenuItem item) {\r\n        switch (item.getItemId()) {\r\n            case R.id.action_date_range:\r\n                showSelectDateRangeDialog();\r\n                return true;\r\n            case R.id.action_options:\r\n                startActivity(new Intent(getActivity(), OptionsActivity.class));\r\n            default:\r\n                return super.onOptionsItemSelected(item);\r\n        }\r\n    }\r\n\r\n    private void showSelectDateRangeDialog() {\r\n        SmoothDateRangePickerFragment datePicker = SmoothDateRangePickerFragment.newInstance(new SmoothDateRangePickerFragment.OnDateRangeSetListener() {\r\n            @Override\r\n            public void onDateRangeSet(SmoothDateRangePickerFragment view, int yearStart, int monthStart, int dayStart, int yearEnd, int monthEnd, int dayEnd) {\r\n                calendarStart = Calendar.getInstance();\r\n                calendarStart.set(yearStart, monthStart, dayStart);\r\n                calendarStart.set(Calendar.HOUR_OF_DAY, 0);\r\n                calendarStart.set(Calendar.MINUTE, 0);\r\n                calendarStart.set(Calendar.SECOND, 0);\r\n\r\n                calendarEnd = Calendar.getInstance();\r\n                calendarEnd.set(yearEnd, monthEnd, dayEnd);\r\n                calendarEnd.set(Calendar.HOUR_OF_DAY, 23);\r\n                calendarEnd.set(Calendar.MINUTE, 59);\r\n                calendarEnd.set(Calendar.SECOND, 59);\r\n                calendarUpdated();\r\n                updateCalendarIcon(true);\r\n            }\r\n        });\r\n        datePicker.show(getActivity().getFragmentManager(), \"TAG\");\r\n        //todo library doesn't respect other method than deprecated\r\n    }\r\n\r\n\r\n    private void calendarUpdated() {\r\n        TopWalletEntriesStatisticsViewModelFactory.getModel(getUid(), getActivity()).setDateFilter(calendarStart, calendarEnd);\r\n\r\n    }\r\n\r\n\r\n}\r\n
===================================================================
--- app/src/main/java/pl/cyfrogen/budget/ui/main/statistics/StatisticsFragment.java	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/java/pl/cyfrogen/budget/ui/main/statistics/StatisticsFragment.java	(date 1622841781127)
@@ -41,10 +41,10 @@
 import pl.cyfrogen.budget.firebase.models.WalletEntry;
 import pl.cyfrogen.budget.firebase.viewmodel_factories.TopWalletEntriesStatisticsViewModelFactory;
 import pl.cyfrogen.budget.firebase.viewmodel_factories.UserProfileViewModelFactory;
-import pl.cyfrogen.budget.util.CalendarHelper;
-import pl.cyfrogen.budget.util.CategoriesHelper;
 import pl.cyfrogen.budget.models.Category;
 import pl.cyfrogen.budget.ui.options.OptionsActivity;
+import pl.cyfrogen.budget.util.CalendarHelper;
+import pl.cyfrogen.budget.util.CategoriesHelper;
 import pl.cyfrogen.budget.util.CurrencyHelper;
 
 
@@ -273,8 +273,7 @@
                 updateCalendarIcon(true);
             }
         });
-        datePicker.show(getActivity().getFragmentManager(), "TAG");
-        //todo library doesn't respect other method than deprecated
+
     }
 
 
Index: app/src/main/res/layout/activity_add_custom_category.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<android.support.constraint.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.options.categories.AddCustomCategoryActivity\">\r\n\r\n    <Button\r\n        android:id=\"@+id/add_custom_category_button\"\r\n        style=\"@style/Widget.AppCompat.Button.Colored\"\r\n        android:layout_width=\"120dp\"\r\n        android:layout_height=\"52dp\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        android:layout_gravity=\"center_horizontal\"\r\n        android:layout_marginStart=\"8dp\"\r\n        android:layout_marginEnd=\"8dp\"\r\n        android:layout_marginBottom=\"8dp\"\r\n        android:backgroundTint=\"@color/colorPrimary\"\r\n        android:paddingLeft=\"8dp\"\r\n        android:paddingRight=\"8dp\"\r\n        android:text=\"Add\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\" />\r\n\r\n    <android.support.v7.widget.Toolbar\r\n        android:id=\"@+id/toolbar\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:background=\"?attr/colorPrimary\"\r\n        android:elevation=\"0dp\"\r\n        android:theme=\"@style/ToolbarTheme\"\r\n        app:layout_scrollFlags=\"scroll|enterAlways|snap\"\r\n        app:popupTheme=\"@style/ThemeOverlay.AppCompat.Light\"\r\n        app:titleTextColor=\"@color/textColorPrimary\" />\r\n\r\n    <ScrollView\r\n        android:id=\"@+id/scrollView2\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0dp\"\r\n        app:layout_constraintBottom_toTopOf=\"@+id/add_entry_button\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/toolbar\"\r\n        app:layout_constraintVertical_bias=\"0.0\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_alignParentStart=\"true\"\r\n            android:layout_alignParentTop=\"true\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <ImageView\r\n                android:id=\"@+id/icon_imageview\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:background=\"@drawable/icon_background_circle\"\r\n                android:backgroundTint=\"@color/colorPrimary\"\r\n                android:padding=\"10dp\"\r\n                android:src=\"@drawable/category_default\"\r\n                android:tint=\"#FFFFFF\"\r\n                app:layout_constraintBottom_toBottomOf=\"parent\"\r\n                app:layout_constraintStart_toStartOf=\"parent\"\r\n                app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n            <View\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"1dp\"\r\n                android:layout_marginLeft=\"12dp\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:layout_marginRight=\"12dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:background=\"@color/divider_color\" />\r\n\r\n            <Button\r\n                android:id=\"@+id/select_color_button\"\r\n                style=\"@style/Widget.AppCompat.Button.Colored\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"52dp\"\r\n                android:layout_centerHorizontal=\"true\"\r\n                android:layout_gravity=\"center_horizontal\"\r\n                android:layout_marginStart=\"8dp\"\r\n                android:layout_marginEnd=\"8dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:backgroundTint=\"@color/colorPrimary\"\r\n                android:paddingLeft=\"8dp\"\r\n                android:paddingRight=\"8dp\"\r\n                android:text=\"Select color\"\r\n                app:layout_constraintBottom_toBottomOf=\"parent\"\r\n                app:layout_constraintEnd_toEndOf=\"parent\"\r\n                app:layout_constraintStart_toStartOf=\"parent\" />\r\n\r\n            <View\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"1dp\"\r\n                android:layout_marginLeft=\"12dp\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:layout_marginRight=\"12dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:background=\"@color/divider_color\" />\r\n\r\n            <android.support.design.widget.TextInputLayout\r\n                android:id=\"@+id/select_name_inputlayout\"\r\n                style=\"@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginLeft=\"8dp\"\r\n                android:layout_marginRight=\"8dp\"\r\n                android:layout_marginBottom=\"16dp\"\r\n                android:hint=\"Name\"\r\n                app:layout_constraintTop_toBottomOf=\"@+id/sign_out_button\">\r\n\r\n                <android.support.design.widget.TextInputEditText\r\n                    android:id=\"@+id/select_name_edittext\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                     />\r\n\r\n            </android.support.design.widget.TextInputLayout>\r\n\r\n        </LinearLayout>\r\n    </ScrollView>\r\n</android.support.constraint.ConstraintLayout>
===================================================================
--- app/src/main/res/layout/activity_add_custom_category.xml	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/res/layout/activity_add_custom_category.xml	(date 1622811378914)
@@ -59,7 +59,7 @@
                 android:background="@drawable/icon_background_circle"
                 android:backgroundTint="@color/colorPrimary"
                 android:padding="10dp"
-                android:src="@drawable/category_default"
+                app:srcCompat="@drawable/category_default"
                 android:tint="#FFFFFF"
                 app:layout_constraintBottom_toBottomOf="parent"
                 app:layout_constraintStart_toStartOf="parent"
Index: app/src/main/java/pl/cyfrogen/budget/ui/options/categories/CustomCategoriesAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package pl.cyfrogen.budget.ui.options.categories;\r\n\r\nimport android.app.Activity;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.content.res.ColorStateList;\r\nimport android.support.v4.content.ContextCompat;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ArrayAdapter;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\nimport pl.cyfrogen.budget.R;\r\nimport pl.cyfrogen.budget.models.Category;\r\nimport pl.cyfrogen.budget.util.CurrencyHelper;\r\n\r\npublic class CustomCategoriesAdapter extends ArrayAdapter<Category> implements View.OnClickListener {\r\n\r\n    private final Activity activity;\r\n    Context context;\r\n\r\n    public CustomCategoriesAdapter(Activity activity, List<Category> data, Context context) {\r\n        super(context, R.layout.favorites_listview_row, data);\r\n        this.context = context;\r\n        this.activity = activity;\r\n\r\n    }\r\n\r\n    @Override\r\n    public void onClick(View v) {\r\n\r\n    }\r\n\r\n\r\n    @Override\r\n    public View getView(int position, View convertView, ViewGroup parent) {\r\n        View listItem = convertView;\r\n        if (listItem == null)\r\n            listItem = LayoutInflater.from(context).inflate(R.layout.custom_categories_listview_row, parent, false);\r\n\r\n        Category category = getItem(position);\r\n\r\n        TextView categoryNameTextView = listItem.findViewById(R.id.category_textview);\r\n        ImageView iconImageView = listItem.findViewById(R.id.icon_imageview);\r\n\r\n        iconImageView.setImageResource(category.getIconResourceID());\r\n        iconImageView.setBackgroundTintList(ColorStateList.valueOf(category.getIconColor()));\r\n\r\n        categoryNameTextView.setText(category.getCategoryVisibleName(getContext()));\r\n\r\n\r\n        listItem.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(activity, EditCustomCategoryActivity.class);\r\n                intent.putExtra(\"category-id\", category.getCategoryID());\r\n                intent.putExtra(\"category-name\", category.getCategoryVisibleName(getContext()));\r\n                intent.putExtra(\"category-color\", category.getIconColor());\r\n                activity.startActivity(intent);\r\n            }\r\n        });\r\n        return listItem;\r\n    }\r\n\r\n\r\n}\r\n
===================================================================
--- app/src/main/java/pl/cyfrogen/budget/ui/options/categories/CustomCategoriesAdapter.java	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/java/pl/cyfrogen/budget/ui/options/categories/CustomCategoriesAdapter.java	(date 1622811378321)
@@ -1,10 +1,9 @@
 package pl.cyfrogen.budget.ui.options.categories;
 
-import android.app.Activity;
 import android.content.Context;
 import android.content.Intent;
 import android.content.res.ColorStateList;
-import android.support.v4.content.ContextCompat;
+import android.support.v7.app.AppCompatActivity;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
@@ -12,19 +11,17 @@
 import android.widget.ImageView;
 import android.widget.TextView;
 
-import java.util.ArrayList;
 import java.util.List;
 
 import pl.cyfrogen.budget.R;
 import pl.cyfrogen.budget.models.Category;
-import pl.cyfrogen.budget.util.CurrencyHelper;
 
 public class CustomCategoriesAdapter extends ArrayAdapter<Category> implements View.OnClickListener {
 
-    private final Activity activity;
+    private final AppCompatActivity activity;
     Context context;
 
-    public CustomCategoriesAdapter(Activity activity, List<Category> data, Context context) {
+    public CustomCategoriesAdapter(AppCompatActivity activity, List<Category> data, Context context) {
         super(context, R.layout.favorites_listview_row, data);
         this.context = context;
         this.activity = activity;
Index: app/src/main/res/layout/custom_categories_listview_row.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><android.support.v7.widget.CardView xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:layout_margin=\"5dp\"\r\n    android:elevation=\"10dp\"\r\n    android:clickable=\"true\"\r\n    android:focusable=\"true\"\r\n    android:foreground=\"?android:attr/selectableItemBackground\">\r\n\r\n    <android.support.constraint.ConstraintLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"92dp\"\r\n        android:orientation=\"vertical\"\r\n        android:paddingLeft=\"16dp\"\r\n        android:paddingTop=\"16dp\"\r\n        android:paddingRight=\"16dp\"\r\n        android:paddingBottom=\"16dp\">\r\n\r\n        <ImageView\r\n            android:id=\"@+id/icon_imageview\"\r\n            android:layout_width=\"40dp\"\r\n            android:layout_height=\"40dp\"\r\n            android:padding=\"10dp\"\r\n            app:layout_constraintBottom_toBottomOf=\"parent\"\r\n            app:layout_constraintStart_toStartOf=\"parent\"\r\n            app:layout_constraintTop_toTopOf=\"parent\"\r\n            android:background=\"@drawable/icon_background_circle\"\r\n            android:src=\"@drawable/category_briefcase\"\r\n            android:tint=\"#FFFFFF\"\r\n            android:backgroundTint=\"@color/colorPrimary\"/>\r\n\r\n        <TextView\r\n            android:id=\"@+id/category_textview\"\r\n            android:layout_width=\"0dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_alignParentTop=\"true\"\r\n            android:layout_centerVertical=\"true\"\r\n            android:layout_marginStart=\"24dp\"\r\n            android:text=\"Foods\"\r\n            android:textColor=\"@color/primary_text_material_light\"\r\n            android:textSize=\"16sp\"\r\n            app:layout_constraintBottom_toBottomOf=\"parent\"\r\n            app:layout_constraintStart_toEndOf=\"@+id/icon_imageview\"\r\n            app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n\r\n    </android.support.constraint.ConstraintLayout>\r\n</android.support.v7.widget.CardView>
===================================================================
--- app/src/main/res/layout/custom_categories_listview_row.xml	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/res/layout/custom_categories_listview_row.xml	(date 1622811378211)
@@ -7,7 +7,7 @@
     android:elevation="10dp"
     android:clickable="true"
     android:focusable="true"
-    android:foreground="?android:attr/selectableItemBackground">
+    android:foreground="?attr/selectableItemBackground">
 
     <android.support.constraint.ConstraintLayout
         android:layout_width="match_parent"
@@ -27,7 +27,7 @@
             app:layout_constraintStart_toStartOf="parent"
             app:layout_constraintTop_toTopOf="parent"
             android:background="@drawable/icon_background_circle"
-            android:src="@drawable/category_briefcase"
+            app:srcCompat="@drawable/category_briefcase"
             android:tint="#FFFFFF"
             android:backgroundTint="@color/colorPrimary"/>
 
Index: app/src/main/res/layout/activity_edit_custom_category.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<android.support.constraint.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.options.categories.AddCustomCategoryActivity\">\r\n\r\n    <Button\r\n        android:id=\"@+id/edit_custom_category_button\"\r\n        style=\"@style/Widget.AppCompat.Button.Colored\"\r\n        android:layout_width=\"120dp\"\r\n        android:layout_height=\"52dp\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        android:layout_gravity=\"center_horizontal\"\r\n        android:layout_marginStart=\"8dp\"\r\n        android:layout_marginEnd=\"8dp\"\r\n        android:layout_marginBottom=\"8dp\"\r\n        android:backgroundTint=\"@color/colorPrimary\"\r\n        android:paddingLeft=\"8dp\"\r\n        android:paddingRight=\"8dp\"\r\n        android:text=\"OK\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintEnd_toStartOf=\"@+id/remove_custom_category_button\"\r\n        app:layout_constraintHorizontal_bias=\"0.5\"\r\n        app:layout_constraintStart_toStartOf=\"parent\" />\r\n\r\n    <Button\r\n        android:id=\"@+id/remove_custom_category_button\"\r\n        style=\"@style/Widget.AppCompat.Button.Colored\"\r\n        android:layout_width=\"120dp\"\r\n        android:layout_height=\"52dp\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        android:layout_gravity=\"center_horizontal\"\r\n        android:layout_marginStart=\"8dp\"\r\n        android:layout_marginEnd=\"8dp\"\r\n        android:layout_marginBottom=\"8dp\"\r\n        android:backgroundTint=\"@color/colorPrimary\"\r\n        android:paddingLeft=\"8dp\"\r\n        android:paddingRight=\"8dp\"\r\n        android:text=\"Remove\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.5\"\r\n        app:layout_constraintStart_toEndOf=\"@+id/edit_custom_category_button\" />\r\n\r\n    <android.support.v7.widget.Toolbar\r\n        android:id=\"@+id/toolbar\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:background=\"?attr/colorPrimary\"\r\n        android:elevation=\"0dp\"\r\n        android:theme=\"@style/ToolbarTheme\"\r\n        app:layout_scrollFlags=\"scroll|enterAlways|snap\"\r\n        app:popupTheme=\"@style/ThemeOverlay.AppCompat.Light\"\r\n        app:titleTextColor=\"@color/textColorPrimary\" />\r\n\r\n    <ScrollView\r\n        android:id=\"@+id/scrollView2\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0dp\"\r\n        app:layout_constraintBottom_toTopOf=\"@+id/add_entry_button\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/toolbar\"\r\n        app:layout_constraintVertical_bias=\"0.0\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_alignParentStart=\"true\"\r\n            android:layout_alignParentTop=\"true\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <ImageView\r\n                android:id=\"@+id/icon_imageview\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:background=\"@drawable/icon_background_circle\"\r\n                android:backgroundTint=\"@color/colorPrimary\"\r\n                android:padding=\"10dp\"\r\n                android:src=\"@drawable/category_default\"\r\n                android:tint=\"#FFFFFF\"\r\n                app:layout_constraintBottom_toBottomOf=\"parent\"\r\n                app:layout_constraintStart_toStartOf=\"parent\"\r\n                app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n            <View\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"1dp\"\r\n                android:layout_marginLeft=\"12dp\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:layout_marginRight=\"12dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:background=\"@color/divider_color\" />\r\n\r\n            <Button\r\n                android:id=\"@+id/select_color_button\"\r\n                style=\"@style/Widget.AppCompat.Button.Colored\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"52dp\"\r\n                android:layout_centerHorizontal=\"true\"\r\n                android:layout_gravity=\"center_horizontal\"\r\n                android:layout_marginStart=\"8dp\"\r\n                android:layout_marginEnd=\"8dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:backgroundTint=\"@color/colorPrimary\"\r\n                android:paddingLeft=\"8dp\"\r\n                android:paddingRight=\"8dp\"\r\n                android:text=\"Select color\"\r\n                app:layout_constraintBottom_toBottomOf=\"parent\"\r\n                app:layout_constraintEnd_toEndOf=\"parent\"\r\n                app:layout_constraintStart_toStartOf=\"parent\" />\r\n\r\n            <View\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"1dp\"\r\n                android:layout_marginLeft=\"12dp\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:layout_marginRight=\"12dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:background=\"@color/divider_color\" />\r\n\r\n            <android.support.design.widget.TextInputLayout\r\n                android:id=\"@+id/select_name_inputlayout\"\r\n                style=\"@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginLeft=\"8dp\"\r\n                android:layout_marginRight=\"8dp\"\r\n                android:layout_marginBottom=\"16dp\"\r\n                android:hint=\"Name\"\r\n                app:layout_constraintTop_toBottomOf=\"@+id/sign_out_button\">\r\n\r\n                <android.support.design.widget.TextInputEditText\r\n                    android:id=\"@+id/select_name_edittext\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                     />\r\n\r\n            </android.support.design.widget.TextInputLayout>\r\n\r\n        </LinearLayout>\r\n    </ScrollView>\r\n</android.support.constraint.ConstraintLayout>
===================================================================
--- app/src/main/res/layout/activity_edit_custom_category.xml	(revision 90053cd17a7627fa595e1a72a7fd8e41d61b7ab3)
+++ app/src/main/res/layout/activity_edit_custom_category.xml	(date 1622811378713)
@@ -80,7 +80,7 @@
                 android:background="@drawable/icon_background_circle"
                 android:backgroundTint="@color/colorPrimary"
                 android:padding="10dp"
-                android:src="@drawable/category_default"
+                app:srcCompat="@drawable/category_default"
                 android:tint="#FFFFFF"
                 app:layout_constraintBottom_toBottomOf="parent"
                 app:layout_constraintStart_toStartOf="parent"
